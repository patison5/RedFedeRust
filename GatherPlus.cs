using System; using System.Collections.Generic; using Oxide.Core; using Oxide.Core.Plugins; using UnityEngine; using System.Linq; using Newtonsoft.Json; namespace Oxide.Plugins { [Info("GatherPlus", "Nimant", "1.0.2")] class GatherPlus : RustPlugin { private Dictionary<ulong, List<string>> WwXbhfUmHwdEisGXLMMfzAVlJpuUX = new Dictionary<ulong, List<string>>(); private bool SqRgwrDxYnDVuwSbfW = false; private void Init() { euNavUPrWdBrLjYyabbf(); if (JEcNNbtuexQFyohUGwtN.BqsKlrnoxdpCHVRVwOnK == null) { JEcNNbtuexQFyohUGwtN.FkHOmxHPkyzROe = 1f; JEcNNbtuexQFyohUGwtN.JPdDkczYXKe = 1f; JEcNNbtuexQFyohUGwtN.BqsKlrnoxdpCHVRVwOnK = new Dictionary<string, float>() { { "High Quality Metal Ore", 1f }, { "Metal Fragments", 1f }, { "Metal Ore", 1f }, { "Stones", 1f }, { "Sulfur Ore", 1f } }; EgYVPhuRCmgqMHfsnwkNnj(JEcNNbtuexQFyohUGwtN); } LoadDefaultMessages(); foreach(var VkxabuApLUiNmmgEo in JEcNNbtuexQFyohUGwtN.FPNXhiKuaXPbVo.Keys) permission.RegisterPermission(VkxabuApLUiNmmgEo.ToLower(), this); } private void OnPlayerInit(BasePlayer annYAxYsHzXAMUgJbpXhJnoONxofcU) => uKBcnXxWdqGTltOWCdabuBeqbhQCa(annYAxYsHzXAMUgJbpXhJnoONxofcU.UserIDString); private void OnPlayerDisconnected(BasePlayer annYAxYsHzXAMUgJbpXhJnoONxofcU, string udOPBWLsrtbFAPhJSPJAyM) => WwXbhfUmHwdEisGXLMMfzAVlJpuUX.Remove(annYAxYsHzXAMUgJbpXhJnoONxofcU.userID); private void OnServerInitialized() { MUAwYutSOBdbWK(true); foreach (var annYAxYsHzXAMUgJbpXhJnoONxofcU in BasePlayer.activePlayerList) OnPlayerInit(annYAxYsHzXAMUgJbpXhJnoONxofcU); } private void OnDispenserGather(ResourceDispenser oiCefEdUmMgyZC, BaseEntity KdyrpeqOlybitNuGu, Item VfftJgNdPdYCdNcWg) { if (KdyrpeqOlybitNuGu == null || VfftJgNdPdYCdNcWg == null) return; BasePlayer annYAxYsHzXAMUgJbpXhJnoONxofcU = KdyrpeqOlybitNuGu.ToPlayer(); if(annYAxYsHzXAMUgJbpXhJnoONxofcU == null) return; kNlojTmfQzSsExLJu(VfftJgNdPdYCdNcWg); var yaCJEgyYaHjnArrb = ChuSOvHhpeBToiACTkzLzzBdgyFqm(annYAxYsHzXAMUgJbpXhJnoONxofcU); var JcCqSeTZDTAYgHJvuTnaiKZTC = qtKjzWVwjHCrAgHWaqnqhWqi(annYAxYsHzXAMUgJbpXhJnoONxofcU.userID); if (JcCqSeTZDTAYgHJvuTnaiKZTC < 0) return; wwSggARWmEKId(VfftJgNdPdYCdNcWg, JcCqSeTZDTAYgHJvuTnaiKZTC * JEcNNbtuexQFyohUGwtN.NIExBRsQFtEcHkNeQPazXxRH[VfftJgNdPdYCdNcWg.info.displayName.english] * (yaCJEgyYaHjnArrb != null ? JEcNNbtuexQFyohUGwtN.QTrfitttSjIYIYJBLhEJBBUHXys[yaCJEgyYaHjnArrb.info.displayName.english] : 1f)); } private void OnDispenserBonus(ResourceDispenser oiCefEdUmMgyZC, BasePlayer annYAxYsHzXAMUgJbpXhJnoONxofcU, Item VfftJgNdPdYCdNcWg) { if (annYAxYsHzXAMUgJbpXhJnoONxofcU == null || VfftJgNdPdYCdNcWg == null) return; kNlojTmfQzSsExLJu(VfftJgNdPdYCdNcWg); var yaCJEgyYaHjnArrb = ChuSOvHhpeBToiACTkzLzzBdgyFqm(annYAxYsHzXAMUgJbpXhJnoONxofcU); var JcCqSeTZDTAYgHJvuTnaiKZTC = qtKjzWVwjHCrAgHWaqnqhWqi(annYAxYsHzXAMUgJbpXhJnoONxofcU.userID); if (JcCqSeTZDTAYgHJvuTnaiKZTC < 0) return; wwSggARWmEKId(VfftJgNdPdYCdNcWg, JcCqSeTZDTAYgHJvuTnaiKZTC * JEcNNbtuexQFyohUGwtN.NIExBRsQFtEcHkNeQPazXxRH[VfftJgNdPdYCdNcWg.info.displayName.english] * (yaCJEgyYaHjnArrb != null ? JEcNNbtuexQFyohUGwtN.QTrfitttSjIYIYJBLhEJBBUHXys[yaCJEgyYaHjnArrb.info.displayName.english] : 1f)); } private void OnCollectiblePickup(Item VfftJgNdPdYCdNcWg, BasePlayer annYAxYsHzXAMUgJbpXhJnoONxofcU) { if (annYAxYsHzXAMUgJbpXhJnoONxofcU == null || VfftJgNdPdYCdNcWg == null) return; gRHjfmidMnaXfUSsmzysJnSPhWHErP(VfftJgNdPdYCdNcWg); var JcCqSeTZDTAYgHJvuTnaiKZTC = MMSdaGOEkRWJAIPxOvJInMjt(annYAxYsHzXAMUgJbpXhJnoONxofcU.userID); if (JcCqSeTZDTAYgHJvuTnaiKZTC < 0) return; wwSggARWmEKId(VfftJgNdPdYCdNcWg, JcCqSeTZDTAYgHJvuTnaiKZTC * JEcNNbtuexQFyohUGwtN.OccllTiqBBeU[VfftJgNdPdYCdNcWg.info.displayName.english]); } private void OnCropGather(PlantEntity UXKbmvGVcRsMFDhM, Item VfftJgNdPdYCdNcWg, BasePlayer annYAxYsHzXAMUgJbpXhJnoONxofcU) { if (annYAxYsHzXAMUgJbpXhJnoONxofcU == null || VfftJgNdPdYCdNcWg == null) return; gRHjfmidMnaXfUSsmzysJnSPhWHErP(VfftJgNdPdYCdNcWg); var JcCqSeTZDTAYgHJvuTnaiKZTC = MMSdaGOEkRWJAIPxOvJInMjt(annYAxYsHzXAMUgJbpXhJnoONxofcU.userID); if (JcCqSeTZDTAYgHJvuTnaiKZTC < 0) return; wwSggARWmEKId(VfftJgNdPdYCdNcWg, JcCqSeTZDTAYgHJvuTnaiKZTC * JEcNNbtuexQFyohUGwtN.OccllTiqBBeU[VfftJgNdPdYCdNcWg.info.displayName.english]); } private void OnQuarryGather(MiningQuarry twZazGfdtXeejVapEMZdRSgz, Item VfftJgNdPdYCdNcWg) { if (twZazGfdtXeejVapEMZdRSgz == null || VfftJgNdPdYCdNcWg == null) return; mAfFtGYYijJZbUQKXwmmJoQJFI(VfftJgNdPdYCdNcWg); var JcCqSeTZDTAYgHJvuTnaiKZTC = YlCWPBNYLg(twZazGfdtXeejVapEMZdRSgz.OwnerID); if (JcCqSeTZDTAYgHJvuTnaiKZTC < 0) return; wwSggARWmEKId(VfftJgNdPdYCdNcWg, JcCqSeTZDTAYgHJvuTnaiKZTC * JEcNNbtuexQFyohUGwtN.SEfdcHnHaXuC[VfftJgNdPdYCdNcWg.info.displayName.english]); } private void OnExcavatorGather(ExcavatorArm XCxhMtNbDUQHRfjAoJBMuPauVvxz, Item VfftJgNdPdYCdNcWg) { if (XCxhMtNbDUQHRfjAoJBMuPauVvxz == null || VfftJgNdPdYCdNcWg == null) return; rAAUuKlfvttteIBLCGuTxuQRVa(VfftJgNdPdYCdNcWg); var JcCqSeTZDTAYgHJvuTnaiKZTC = GetExcavRate(); if (JcCqSeTZDTAYgHJvuTnaiKZTC < 0) return; wwSggARWmEKId(VfftJgNdPdYCdNcWg, JcCqSeTZDTAYgHJvuTnaiKZTC * JEcNNbtuexQFyohUGwtN.BqsKlrnoxdpCHVRVwOnK[VfftJgNdPdYCdNcWg.info.displayName.english]); } private void OnUserPermissionGranted(string XFHTVMVvRrMkJLdILc, string VkxabuApLUiNmmgEo) { if (JEcNNbtuexQFyohUGwtN.FPNXhiKuaXPbVo.Where(x=> x.Key.ToLower() == VkxabuApLUiNmmgEo.ToLower()).Count() > 0) timer.Once(0.1f, ()=> uKBcnXxWdqGTltOWCdabuBeqbhQCa(XFHTVMVvRrMkJLdILc)); } private void OnUserPermissionRevoked(string XFHTVMVvRrMkJLdILc, string VkxabuApLUiNmmgEo) { if (JEcNNbtuexQFyohUGwtN.FPNXhiKuaXPbVo.Where(x=> x.Key.ToLower() == VkxabuApLUiNmmgEo.ToLower()).Count() > 0) timer.Once(0.1f, ()=> uKBcnXxWdqGTltOWCdabuBeqbhQCa(XFHTVMVvRrMkJLdILc)); } private void OnUserGroupAdded(string XFHTVMVvRrMkJLdILc, string aQVvBHDStTsolCyqgRbRpH) => timer.Once(0.1f, ()=> uKBcnXxWdqGTltOWCdabuBeqbhQCa(XFHTVMVvRrMkJLdILc)); private void OnUserGroupRemoved(string XFHTVMVvRrMkJLdILc, string aQVvBHDStTsolCyqgRbRpH) => timer.Once(0.1f, ()=> uKBcnXxWdqGTltOWCdabuBeqbhQCa(XFHTVMVvRrMkJLdILc)); private void OnGroupPermissionGranted(string aQVvBHDStTsolCyqgRbRpH, string VkxabuApLUiNmmgEo) { if (JEcNNbtuexQFyohUGwtN.FPNXhiKuaXPbVo.Where(x=> x.Key.ToLower() == VkxabuApLUiNmmgEo.ToLower()).Count() > 0) timer.Once(0.1f, ()=> bOpKnLzgrQapf(aQVvBHDStTsolCyqgRbRpH)); } private void OnGroupPermissionRevoked(string aQVvBHDStTsolCyqgRbRpH, string VkxabuApLUiNmmgEo) { if (JEcNNbtuexQFyohUGwtN.FPNXhiKuaXPbVo.Where(x=> x.Key.ToLower() == VkxabuApLUiNmmgEo.ToLower()).Count() > 0) timer.Once(0.1f, ()=> bOpKnLzgrQapf(aQVvBHDStTsolCyqgRbRpH)); } private void kNlojTmfQzSsExLJu(Item VfftJgNdPdYCdNcWg) { if (!JEcNNbtuexQFyohUGwtN.NIExBRsQFtEcHkNeQPazXxRH.ContainsKey(VfftJgNdPdYCdNcWg.info.displayName.english)) { JEcNNbtuexQFyohUGwtN.NIExBRsQFtEcHkNeQPazXxRH.Add(VfftJgNdPdYCdNcWg.info.displayName.english, 1f); EgYVPhuRCmgqMHfsnwkNnj(JEcNNbtuexQFyohUGwtN); PrintWarning(string.Format("В конфигурационный файл, в раздел добываемых ресурсов добавлен новый ресурс '{0}'", VfftJgNdPdYCdNcWg.info.displayName.english)); } } private Item ChuSOvHhpeBToiACTkzLzzBdgyFqm(BasePlayer annYAxYsHzXAMUgJbpXhJnoONxofcU) { if (annYAxYsHzXAMUgJbpXhJnoONxofcU == null) return null; var VfftJgNdPdYCdNcWg = annYAxYsHzXAMUgJbpXhJnoONxofcU.GetActiveItem(); if (VfftJgNdPdYCdNcWg == null) return null; if (JEcNNbtuexQFyohUGwtN.QTrfitttSjIYIYJBLhEJBBUHXys == null) JEcNNbtuexQFyohUGwtN.QTrfitttSjIYIYJBLhEJBBUHXys = new Dictionary<string, float>(); if (!JEcNNbtuexQFyohUGwtN.QTrfitttSjIYIYJBLhEJBBUHXys.ContainsKey(VfftJgNdPdYCdNcWg.info.displayName.english)) { JEcNNbtuexQFyohUGwtN.QTrfitttSjIYIYJBLhEJBBUHXys.Add(VfftJgNdPdYCdNcWg.info.displayName.english, 1f); EgYVPhuRCmgqMHfsnwkNnj(JEcNNbtuexQFyohUGwtN); PrintWarning(string.Format("В конфигурационный файл, в раздел инструментов добычи добавлен новый ресурс '{0}'", VfftJgNdPdYCdNcWg.info.displayName.english)); } return VfftJgNdPdYCdNcWg; } private void gRHjfmidMnaXfUSsmzysJnSPhWHErP(Item VfftJgNdPdYCdNcWg) { if (!JEcNNbtuexQFyohUGwtN.OccllTiqBBeU.ContainsKey(VfftJgNdPdYCdNcWg.info.displayName.english)) { JEcNNbtuexQFyohUGwtN.OccllTiqBBeU.Add(VfftJgNdPdYCdNcWg.info.displayName.english, 1f); EgYVPhuRCmgqMHfsnwkNnj(JEcNNbtuexQFyohUGwtN); PrintWarning(string.Format("В конфигурационный файл, в раздел поднимаемых ресурсов добавлен новый ресурс '{0}'", VfftJgNdPdYCdNcWg.info.displayName.english)); } } private void mAfFtGYYijJZbUQKXwmmJoQJFI(Item VfftJgNdPdYCdNcWg) { if (!JEcNNbtuexQFyohUGwtN.SEfdcHnHaXuC.ContainsKey(VfftJgNdPdYCdNcWg.info.displayName.english)) { JEcNNbtuexQFyohUGwtN.SEfdcHnHaXuC.Add(VfftJgNdPdYCdNcWg.info.displayName.english, 1f); EgYVPhuRCmgqMHfsnwkNnj(JEcNNbtuexQFyohUGwtN); PrintWarning(string.Format("В конфигурационный файл, в раздел добываемых ресурсов в карьере добавлен новый ресурс '{0}'", VfftJgNdPdYCdNcWg.info.displayName.english)); } } private void rAAUuKlfvttteIBLCGuTxuQRVa(Item VfftJgNdPdYCdNcWg) { if (!JEcNNbtuexQFyohUGwtN.BqsKlrnoxdpCHVRVwOnK.ContainsKey(VfftJgNdPdYCdNcWg.info.displayName.english)) { JEcNNbtuexQFyohUGwtN.BqsKlrnoxdpCHVRVwOnK.Add(VfftJgNdPdYCdNcWg.info.displayName.english, 1f); EgYVPhuRCmgqMHfsnwkNnj(JEcNNbtuexQFyohUGwtN); PrintWarning(string.Format("В конфигурационный файл, в раздел добываемых ресурсов экскаватором добавлен новый ресурс '{0}'", VfftJgNdPdYCdNcWg.info.displayName.english)); } } private void wwSggARWmEKId(Item VfftJgNdPdYCdNcWg, float JcCqSeTZDTAYgHJvuTnaiKZTC) { if (JcCqSeTZDTAYgHJvuTnaiKZTC <= 0 || VfftJgNdPdYCdNcWg.amount <= 0) { VfftJgNdPdYCdNcWg.RemoveFromContainer(); VfftJgNdPdYCdNcWg.Remove(0f); } else { var yFnNHgTeUdtstsyMMGJ = (int)Math.Round(JcCqSeTZDTAYgHJvuTnaiKZTC * VfftJgNdPdYCdNcWg.amount); if (yFnNHgTeUdtstsyMMGJ <= 0) { VfftJgNdPdYCdNcWg.RemoveFromContainer(); VfftJgNdPdYCdNcWg.Remove(0f); } else VfftJgNdPdYCdNcWg.amount = yFnNHgTeUdtstsyMMGJ; } } private float qtKjzWVwjHCrAgHWaqnqhWqi(ulong sIVRjGbIyDch) { float RgUEUolJdiSkpqtqjdkPbgtMtzYuxd = (JEcNNbtuexQFyohUGwtN.pgJIFndaUfqCFbW && SqRgwrDxYnDVuwSbfW) ? JEcNNbtuexQFyohUGwtN.uWVOtiVeLtfireNwcpZAsoDACNZE : JEcNNbtuexQFyohUGwtN.pXyqLSVYbzJvwghmvGzt; if (!WwXbhfUmHwdEisGXLMMfzAVlJpuUX.ContainsKey(sIVRjGbIyDch)) return RgUEUolJdiSkpqtqjdkPbgtMtzYuxd; else { float JcCqSeTZDTAYgHJvuTnaiKZTC = -1; foreach(var YOGjZPZIhqOlxbxidcs in JEcNNbtuexQFyohUGwtN.FPNXhiKuaXPbVo.Where(x=> WwXbhfUmHwdEisGXLMMfzAVlJpuUX[sIVRjGbIyDch].Contains(x.Key.ToLower()))) { if (JEcNNbtuexQFyohUGwtN.pgJIFndaUfqCFbW && SqRgwrDxYnDVuwSbfW) { if (JcCqSeTZDTAYgHJvuTnaiKZTC < YOGjZPZIhqOlxbxidcs.Value.uWVOtiVeLtfireNwcpZAsoDACNZE) JcCqSeTZDTAYgHJvuTnaiKZTC = YOGjZPZIhqOlxbxidcs.Value.uWVOtiVeLtfireNwcpZAsoDACNZE; } else { if (JcCqSeTZDTAYgHJvuTnaiKZTC < YOGjZPZIhqOlxbxidcs.Value.pXyqLSVYbzJvwghmvGzt) JcCqSeTZDTAYgHJvuTnaiKZTC = YOGjZPZIhqOlxbxidcs.Value.pXyqLSVYbzJvwghmvGzt; } } return JcCqSeTZDTAYgHJvuTnaiKZTC >= 0 ? JcCqSeTZDTAYgHJvuTnaiKZTC : RgUEUolJdiSkpqtqjdkPbgtMtzYuxd; } return RgUEUolJdiSkpqtqjdkPbgtMtzYuxd; } private float MMSdaGOEkRWJAIPxOvJInMjt(ulong sIVRjGbIyDch) { float RgUEUolJdiSkpqtqjdkPbgtMtzYuxd = (JEcNNbtuexQFyohUGwtN.pgJIFndaUfqCFbW && SqRgwrDxYnDVuwSbfW) ? JEcNNbtuexQFyohUGwtN.dBSvAxTSGNLJ : JEcNNbtuexQFyohUGwtN.sTWJXnJMhXPCqXWnbghVE; if (!WwXbhfUmHwdEisGXLMMfzAVlJpuUX.ContainsKey(sIVRjGbIyDch)) return RgUEUolJdiSkpqtqjdkPbgtMtzYuxd; else { float JcCqSeTZDTAYgHJvuTnaiKZTC = -1; foreach(var YOGjZPZIhqOlxbxidcs in JEcNNbtuexQFyohUGwtN.FPNXhiKuaXPbVo.Where(x=> WwXbhfUmHwdEisGXLMMfzAVlJpuUX[sIVRjGbIyDch].Contains(x.Key.ToLower()))) { if (JEcNNbtuexQFyohUGwtN.pgJIFndaUfqCFbW && SqRgwrDxYnDVuwSbfW) { if (JcCqSeTZDTAYgHJvuTnaiKZTC < YOGjZPZIhqOlxbxidcs.Value.dBSvAxTSGNLJ) JcCqSeTZDTAYgHJvuTnaiKZTC = YOGjZPZIhqOlxbxidcs.Value.dBSvAxTSGNLJ; } else { if (JcCqSeTZDTAYgHJvuTnaiKZTC < YOGjZPZIhqOlxbxidcs.Value.sTWJXnJMhXPCqXWnbghVE) JcCqSeTZDTAYgHJvuTnaiKZTC = YOGjZPZIhqOlxbxidcs.Value.sTWJXnJMhXPCqXWnbghVE; } } return JcCqSeTZDTAYgHJvuTnaiKZTC >= 0 ? JcCqSeTZDTAYgHJvuTnaiKZTC : RgUEUolJdiSkpqtqjdkPbgtMtzYuxd; } return RgUEUolJdiSkpqtqjdkPbgtMtzYuxd; } private float YlCWPBNYLg(ulong sIVRjGbIyDch) { float RgUEUolJdiSkpqtqjdkPbgtMtzYuxd = (JEcNNbtuexQFyohUGwtN.pgJIFndaUfqCFbW && SqRgwrDxYnDVuwSbfW) ? JEcNNbtuexQFyohUGwtN.agUhnRJidievyIzdiw : JEcNNbtuexQFyohUGwtN.QxtmtNVusWtJCYKGoCX; if (sIVRjGbIyDch == 0) return RgUEUolJdiSkpqtqjdkPbgtMtzYuxd; List<string> whQzQcRPmiXdNgPW = new List<string>(); foreach(var YTrWJuVWZZlWLhjcQTW in JEcNNbtuexQFyohUGwtN.FPNXhiKuaXPbVo.Keys) if (permission.UserHasPermission(sIVRjGbIyDch.ToString(), YTrWJuVWZZlWLhjcQTW.ToLower())) whQzQcRPmiXdNgPW.Add(YTrWJuVWZZlWLhjcQTW.ToLower()); if (whQzQcRPmiXdNgPW.Count == 0) return RgUEUolJdiSkpqtqjdkPbgtMtzYuxd; float JcCqSeTZDTAYgHJvuTnaiKZTC = -1; foreach(var YOGjZPZIhqOlxbxidcs in JEcNNbtuexQFyohUGwtN.FPNXhiKuaXPbVo.Where(x=> whQzQcRPmiXdNgPW.Contains(x.Key.ToLower()))) { if (JEcNNbtuexQFyohUGwtN.pgJIFndaUfqCFbW && SqRgwrDxYnDVuwSbfW) { if (JcCqSeTZDTAYgHJvuTnaiKZTC < YOGjZPZIhqOlxbxidcs.Value.agUhnRJidievyIzdiw) JcCqSeTZDTAYgHJvuTnaiKZTC = YOGjZPZIhqOlxbxidcs.Value.agUhnRJidievyIzdiw; } else { if (JcCqSeTZDTAYgHJvuTnaiKZTC < YOGjZPZIhqOlxbxidcs.Value.QxtmtNVusWtJCYKGoCX) JcCqSeTZDTAYgHJvuTnaiKZTC = YOGjZPZIhqOlxbxidcs.Value.QxtmtNVusWtJCYKGoCX; } } return JcCqSeTZDTAYgHJvuTnaiKZTC >= 0 ? JcCqSeTZDTAYgHJvuTnaiKZTC : RgUEUolJdiSkpqtqjdkPbgtMtzYuxd; } private float GetExcavRate() { float RgUEUolJdiSkpqtqjdkPbgtMtzYuxd = (JEcNNbtuexQFyohUGwtN.pgJIFndaUfqCFbW && SqRgwrDxYnDVuwSbfW) ? JEcNNbtuexQFyohUGwtN.JPdDkczYXKe : JEcNNbtuexQFyohUGwtN.FkHOmxHPkyzROe; return RgUEUolJdiSkpqtqjdkPbgtMtzYuxd; } private void uKBcnXxWdqGTltOWCdabuBeqbhQCa(string userIdString) { List<string> QzPbRbXBITLT = new List<string>(); var rdorfNdvnKYSAqMOyOVmD = "628"; foreach(var YTrWJuVWZZlWLhjcQTW in JEcNNbtuexQFyohUGwtN.FPNXhiKuaXPbVo.Keys) if (permission.UserHasPermission(userIdString, YTrWJuVWZZlWLhjcQTW.ToLower())) QzPbRbXBITLT.Add(YTrWJuVWZZlWLhjcQTW.ToLower()); ulong sIVRjGbIyDch = (ulong)Convert.ToInt64(userIdString); if (QzPbRbXBITLT.Count == 0) { if (WwXbhfUmHwdEisGXLMMfzAVlJpuUX.ContainsKey(sIVRjGbIyDch)) WwXbhfUmHwdEisGXLMMfzAVlJpuUX.Remove(sIVRjGbIyDch); } else { if (!WwXbhfUmHwdEisGXLMMfzAVlJpuUX.ContainsKey(sIVRjGbIyDch)) WwXbhfUmHwdEisGXLMMfzAVlJpuUX.Add(sIVRjGbIyDch, QzPbRbXBITLT); else WwXbhfUmHwdEisGXLMMfzAVlJpuUX[sIVRjGbIyDch] = QzPbRbXBITLT; } } private void bOpKnLzgrQapf(string ieysWzbroTsrEwgcKGxTj) { List<string> obpmYGdPOpMhnnaNZdcgudDcH = permission.GetUsersInGroup(ieysWzbroTsrEwgcKGxTj).Select(x=>x.Substring(0, x.IndexOf(" "))).ToList(); foreach(var annYAxYsHzXAMUgJbpXhJnoONxofcU in BasePlayer.activePlayerList.Where(x=> obpmYGdPOpMhnnaNZdcgudDcH.Contains(x.UserIDString))) uKBcnXxWdqGTltOWCdabuBeqbhQCa(annYAxYsHzXAMUgJbpXhJnoONxofcU.UserIDString); } private void MUAwYutSOBdbWK(bool QeXgrYhEdrUlEmLDdjl = false) { var wAXYZNWuFFM = TOD_Sky.Instance.Cycle.Hour; bool TQBfscZSKwWYjbnlHHGXtU = SqRgwrDxYnDVuwSbfW; if ( (JEcNNbtuexQFyohUGwtN.tFJNADdVIQi <= JEcNNbtuexQFyohUGwtN.MaoxcgKPSnkGZhBbWTIyDAwlSyVN && wAXYZNWuFFM >= JEcNNbtuexQFyohUGwtN.tFJNADdVIQi && wAXYZNWuFFM < JEcNNbtuexQFyohUGwtN.MaoxcgKPSnkGZhBbWTIyDAwlSyVN) || (JEcNNbtuexQFyohUGwtN.tFJNADdVIQi > JEcNNbtuexQFyohUGwtN.MaoxcgKPSnkGZhBbWTIyDAwlSyVN && wAXYZNWuFFM >= JEcNNbtuexQFyohUGwtN.tFJNADdVIQi && wAXYZNWuFFM < JEcNNbtuexQFyohUGwtN.MaoxcgKPSnkGZhBbWTIyDAwlSyVN + 24) || (JEcNNbtuexQFyohUGwtN.tFJNADdVIQi > JEcNNbtuexQFyohUGwtN.MaoxcgKPSnkGZhBbWTIyDAwlSyVN && wAXYZNWuFFM + 24 >= JEcNNbtuexQFyohUGwtN.tFJNADdVIQi && wAXYZNWuFFM < JEcNNbtuexQFyohUGwtN.MaoxcgKPSnkGZhBbWTIyDAwlSyVN) ) SqRgwrDxYnDVuwSbfW = true; else SqRgwrDxYnDVuwSbfW = false; if (!QeXgrYhEdrUlEmLDdjl && TQBfscZSKwWYjbnlHHGXtU != SqRgwrDxYnDVuwSbfW) SAqscEoUYZXYFOPmpd(); timer.Once(3f, ()=>MUAwYutSOBdbWK()); } private void SAqscEoUYZXYFOPmpd() { if (JEcNNbtuexQFyohUGwtN.BeFwmKahzwczIWhEuGUXdkaRQvQsM) { foreach(var annYAxYsHzXAMUgJbpXhJnoONxofcU in BasePlayer.activePlayerList) SendReply(annYAxYsHzXAMUgJbpXhJnoONxofcU, string.Format(SqRgwrDxYnDVuwSbfW?WfsDeKwKyemWclcrMgWsretEheI("INFO.NIGHT.START"):WfsDeKwKyemWclcrMgWsretEheI("INFO.NIGHT.END"), qtKjzWVwjHCrAgHWaqnqhWqi(annYAxYsHzXAMUgJbpXhJnoONxofcU.userID), MMSdaGOEkRWJAIPxOvJInMjt(annYAxYsHzXAMUgJbpXhJnoONxofcU.userID), YlCWPBNYLg(annYAxYsHzXAMUgJbpXhJnoONxofcU.userID))); } } private void LoadDefaultMessages() { lang.RegisterMessages(new Dictionary<string, string> { { "INFO.NIGHT.START", "Наступает ночь\nРейты добываемых ресурсов: X{0}\nРейты поднимаемых ресурсов: X{1}\nРейты ресурсов в карьере: X{2}" }, { "INFO.NIGHT.END", "Наступает день\nРейты добываемых ресурсов: X{0}\nРейты поднимаемых ресурсов: X{1}\nРейты ресурсов в карьере: X{2}" } }, this); } private string WfsDeKwKyemWclcrMgWsretEheI(string RSRbhSVcmbXxvq, string cvXvxBdPEsvy = null) => lang.GetMessage(RSRbhSVcmbXxvq, this, cvXvxBdPEsvy); private static RwXtUgYPfGoJjIZ JEcNNbtuexQFyohUGwtN; private class OSkYJwxsbbfObmm { [JsonProperty(PropertyName = "Общий рейт добываемых ресурсов")] public float pXyqLSVYbzJvwghmvGzt; [JsonProperty(PropertyName = "Общий рейт добываемых ресурсов ночью")] public float uWVOtiVeLtfireNwcpZAsoDACNZE; [JsonProperty(PropertyName = "Общий рейт поднимаемых ресурсов")] public float sTWJXnJMhXPCqXWnbghVE; [JsonProperty(PropertyName = "Общий рейт поднимаемых ресурсов ночью")] public float dBSvAxTSGNLJ; [JsonProperty(PropertyName = "Общий рейт добываемых ресурсов в карьере")] public float QxtmtNVusWtJCYKGoCX; [JsonProperty(PropertyName = "Общий рейт добываемых ресурсов в карьере ночью")] public float agUhnRJidievyIzdiw; } private class RwXtUgYPfGoJjIZ { [JsonProperty(PropertyName = "Общий рейт добываемых ресурсов")] public float pXyqLSVYbzJvwghmvGzt; [JsonProperty(PropertyName = "Общий рейт добываемых ресурсов ночью")] public float uWVOtiVeLtfireNwcpZAsoDACNZE; [JsonProperty(PropertyName = "Стандартные рейты добываемых ресурсов")] public Dictionary<string, float> NIExBRsQFtEcHkNeQPazXxRH; [JsonProperty(PropertyName = "Стандартные рейты инструментов добычи")] public Dictionary<string, float> QTrfitttSjIYIYJBLhEJBBUHXys; [JsonProperty(PropertyName = "Общий рейт поднимаемых ресурсов")] public float sTWJXnJMhXPCqXWnbghVE; [JsonProperty(PropertyName = "Общий рейт поднимаемых ресурсов ночью")] public float dBSvAxTSGNLJ; [JsonProperty(PropertyName = "Стандартные рейты поднимаемых ресурсов")] public Dictionary<string, float> OccllTiqBBeU; [JsonProperty(PropertyName = "Общий рейт добываемых ресурсов в карьере")] public float QxtmtNVusWtJCYKGoCX; [JsonProperty(PropertyName = "Общий рейт добываемых ресурсов в карьере ночью")] public float agUhnRJidievyIzdiw; [JsonProperty(PropertyName = "Стандартные рейты добываемых ресурсов в карьере")] public Dictionary<string, float> SEfdcHnHaXuC; [JsonProperty(PropertyName = "Общий рейт добываемых ресурсов экскаватором")] public float FkHOmxHPkyzROe; [JsonProperty(PropertyName = "Общий рейт добываемых ресурсов экскаватором ночью")] public float JPdDkczYXKe; [JsonProperty(PropertyName = "Стандартные рейты добываемых ресурсов экскаватором")] public Dictionary<string, float> BqsKlrnoxdpCHVRVwOnK; [JsonProperty(PropertyName = "Включить разделение рейтов на ночной и дневной режим")] public bool pgJIFndaUfqCFbW; [JsonProperty(PropertyName = "Час игрового времени с которого включается ночной режим")] public int tFJNADdVIQi; [JsonProperty(PropertyName = "Час игрового времени с которого выключается ночной режим")] public int MaoxcgKPSnkGZhBbWTIyDAwlSyVN; [JsonProperty(PropertyName = "Выводить оповещение в чат при смене ночного и дневного режима")] public bool BeFwmKahzwczIWhEuGUXdkaRQvQsM; [JsonProperty(PropertyName = "Изменение рейтов для игроков с привилегиями")] public Dictionary<string, OSkYJwxsbbfObmm> FPNXhiKuaXPbVo; } private void euNavUPrWdBrLjYyabbf() => JEcNNbtuexQFyohUGwtN = Config.ReadObject<RwXtUgYPfGoJjIZ>(); protected override void LoadDefaultConfig() { JEcNNbtuexQFyohUGwtN = new RwXtUgYPfGoJjIZ { pXyqLSVYbzJvwghmvGzt = 1f, uWVOtiVeLtfireNwcpZAsoDACNZE = 1f, NIExBRsQFtEcHkNeQPazXxRH = new Dictionary<string, float>() { { "Animal Fat", 1f }, { "Bear Meat", 1f }, { "Bone Fragments", 1f }, { "Cloth", 1f }, { "High Quality Metal Ore", 1f }, { "Human Skull", 1f }, { "Leather", 1f }, { "Metal Ore", 1f }, { "Pork", 1f }, { "Raw Bear Meat", 1f }, { "Raw Chicken Breast", 1f }, { "Raw Human Meat", 1f }, { "Raw Wolf Meat", 1f }, { "Stones", 1f }, { "Sulfur Ore", 1f }, { "Wolf Skull", 1f }, { "Wood", 1f } }, QTrfitttSjIYIYJBLhEJBBUHXys = new Dictionary<string, float>() { { "Bone Club", 1f }, { "Candy Cane Club", 1f }, { "Chainsaw", 1f }, { "Hatchet", 1f }, { "Pickaxe", 1f }, { "Rock", 1f }, { "Salvaged Axe", 1f }, { "Salvaged Hammer", 1f }, { "Salvaged Icepick", 1f }, { "Stone Hatchet", 1f }, { "Stone Pickaxe", 1f }, { "Jackhammer", 1f } }, sTWJXnJMhXPCqXWnbghVE = 1f, dBSvAxTSGNLJ = 1f, OccllTiqBBeU = new Dictionary<string, float>() { { "Metal Ore", 1f }, { "Stones", 1f }, { "Sulfur Ore", 1f }, { "Wood", 1f }, { "Hemp Seed", 1f }, { "Corn Seed", 1f }, { "Pumpkin Seed", 1f }, { "Cloth", 1f }, { "Pumpkin", 1f }, { "Corn", 1f } }, QxtmtNVusWtJCYKGoCX = 1f, agUhnRJidievyIzdiw = 1f, SEfdcHnHaXuC = new Dictionary<string, float>() { { "High Quality Metal Ore", 1f }, { "Metal Fragments", 1f }, { "Metal Ore", 1f }, { "Stones", 1f }, { "Sulfur Ore", 1f } }, FkHOmxHPkyzROe = 1f, JPdDkczYXKe = 1f, BqsKlrnoxdpCHVRVwOnK = new Dictionary<string, float>() { { "High Quality Metal Ore", 1f }, { "Metal Fragments", 1f }, { "Metal Ore", 1f }, { "Stones", 1f }, { "Sulfur Ore", 1f } }, pgJIFndaUfqCFbW = false, tFJNADdVIQi = 19, MaoxcgKPSnkGZhBbWTIyDAwlSyVN = 8, BeFwmKahzwczIWhEuGUXdkaRQvQsM = true, FPNXhiKuaXPbVo = new Dictionary<string, OSkYJwxsbbfObmm>() { { "gatherplus.vip", new OSkYJwxsbbfObmm() { pXyqLSVYbzJvwghmvGzt = 2f, uWVOtiVeLtfireNwcpZAsoDACNZE = 2f, sTWJXnJMhXPCqXWnbghVE = 2f, dBSvAxTSGNLJ = 2f, QxtmtNVusWtJCYKGoCX = 2f, agUhnRJidievyIzdiw = 2f } }, { "gatherplus.premium", new OSkYJwxsbbfObmm() { pXyqLSVYbzJvwghmvGzt = 3f, uWVOtiVeLtfireNwcpZAsoDACNZE = 3f, sTWJXnJMhXPCqXWnbghVE = 3f, dBSvAxTSGNLJ = 3f, QxtmtNVusWtJCYKGoCX = 3f, agUhnRJidievyIzdiw = 3f } } } }; EgYVPhuRCmgqMHfsnwkNnj(JEcNNbtuexQFyohUGwtN); timer.Once(0.1f, ()=> EgYVPhuRCmgqMHfsnwkNnj(JEcNNbtuexQFyohUGwtN)); } private void EgYVPhuRCmgqMHfsnwkNnj(RwXtUgYPfGoJjIZ anZOHJisxmCFIXzJbgUKfSOHIyCg) => Config.WriteObject(anZOHJisxmCFIXzJbgUKfSOHIyCg, true); } } 
